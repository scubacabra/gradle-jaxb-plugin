apply plugin: 'groovy'

group = 'com.jacobo.gradle.plugins'

repositories { 
  mavenCentral()
}

dependencies {
   compile gradleApi()
   groovy localGroovy()
   testCompile "org.spockframework:spock-core:0.6-groovy-1.8" 
}

task unversionedJar (type: Jar, dependsOn: 'jar') {
	version = null
	from sourceSets.main.output
}

task installPlugin (type: Copy, dependsOn: 'unversionedJar') {
	def gradleInstallDir = gradle.gradleHomeDir
	group = 'installation'
	description = 'Installs the plugin jar in your gradle distribution.'
	from "${buildDir}/libs/${unversionedJar.archiveName}"
	into "/${gradleInstallDir}/lib/plugins"
	doLast { 
	  println "Installed in: ${gradleInstallDir}/lib/plugins as: ${unversionedJar.archiveName}"
	}
}

task uninstallPlugin (type: Delete) {
	def gradleInstallDir = gradle.gradleHomeDir
	group = 'installation'
	description = 'Removes the plugin from your gradle distribution.'
	delete("/${gradleInstallDir}/lib/plugins/${unversionedJar.archiveName}")
}